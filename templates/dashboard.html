{% extends 'layout.html' %}

{% block body %}
<h1>Profile settings</h1>
{% from "includes/_formhelpers.html" import render_field %}
<img src="/static/img/defaultprofile.jpeg" alt="Italian Trulli  "style="width:128px;height:128x;">
<div class="mt-3" id="deleteUser">
  <p class="btn btn-black" id="delBut">Delete Account</p>
</div>
<form form class="w-bg" action="" method="post" >
<div class="form-group">
    {{render_field(form.name, class_="form-control",placeholder=user['name'])}}
  </div>
  <div class="form-group">
    {{render_field(form.username, class_="form-control",placeholder=user['username'])}}
  </div>
  <div class="form-group">
    {{render_field(form.email, class_="form-control",placeholder=user['email'])}}
  </div>
  <div class="form-group">
    {{render_field(form.password, class_="form-control",placeholder="Enter your current password")}}
  </div>
  <div class="form-group">
    {{render_field(form.newpassword, class_="form-control",placeholder="Enter your new password")}}
  </div>

  <input type="submit" value="Submit" class="btn btn-primary btn-black" /> 
</form>
<script>
  var uname = "{{session['username']}}";
$('#deleteUser').on('click', () => {
  $.ajax({
    type: 'POST',
    url: `http://itucsdb1965.herokuapp.com/api/user/delete?username=${uname}`,
    success: () => {
      location.replace('http://itucsdb1965.herokuapp.com/login')
    }
  })
})
</script>
{% endblock %}